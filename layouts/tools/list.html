{{ define "main" }}
<article class="page-content">
  <h1 class="page-title">{{ .Title }}</h1>
  {{ .Content }}

  {{/* Build category lookup map */}}
  {{ $categories := dict }}
  {{ range .Site.Data.categories.categories }}
    {{ $categories = merge $categories (dict .id .label) }}
  {{ end }}

  {{/* Build logo map: tool id -> logo URL */}}
  {{ $logos := dict }}
  {{ range resources.Match "tools/*" }}
    {{ $logos = merge $logos (dict (path.BaseName .Name) .RelPermalink) }}
  {{ end }}

  {{/* Collect and sort tools by name */}}
  {{ $tools := slice }}
  {{ range $filename, $tool := .Site.Data.tools }}
    {{ $tools = $tools | append $tool }}
  {{ end }}
  {{ $tools = sort $tools "name" }}

  <ul class="tools-grid" role="list">
    {{ $scores := index (index .Site.Data "generated" | default dict) "scores" | default dict }}
    {{ range $tools }}
    {{ partial "tool-card.html" (dict "tool" . "categories" $categories "score" (index $scores .id) "logos" $logos) }}
    {{ end }}
  </ul>
</article>
{{ end }}
